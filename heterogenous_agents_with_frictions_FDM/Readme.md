# Heterogenous Agents Model with Frictions

The subfolder solves two-dimensional heterogenous-agent production economies in sections 5.3.4 using Finite Difference

## Scripts Overview

1. **run_1.sh**
   - **main_solve.py**: Solves the model IP using Finite Difference 
     - **_mfrSuite_**: Independe modules to solve heterogenous-agent models, please run `install.sh` in the directory before solving the model
   - **main_evaluate.py**: Evaluates the solved models on specific points we are insterested in
2. **run_2.sh**
   - **main_sim_shock_elasticity.py**: Calculates shock elasticities by simulation
     - **utils_sim_shock_elasticity.py**: Contains source files for continuous-time shock elasticity simulations.
3. **results.ipynb**: Load model solution, plot risk prices, equilibrium varibles, shock elasticities.

## Generated Directory Structure

Running the above bash scripts organizes the outputs and logs into specific directories to streamline troubleshooting and monitoring of script execution:

1. **job-outs**
   - Contains all log and error files associated with the script runs.
     - **run.err**: Generated by run_1.sh, records the training error information
     - **run.out**: Generated by run_1.sh, records the training time information
     - **simela_'seed'.err**: Generated by run_2.sh
     - **simela_'seed'.our**: Generated by run_2.sh
2. **bash**
   - Stores sbatch files for each parameter set, which are used to submit jobs to a computing cluster.
3. **output**
   - Holds the computed model solutions and other outputs.
     - ***_final.dat**: Contains the solved models variables evaluated on state space
     - **log.txt**: Contains log and error files associated with the _mfrSuite_ runs.
     - ***.npz**: Contains shock elasticities
   
## Estimated Running Time
1. **run_1.sh**: < 12 hours
   - each task tested on a single core of Intel Xeon Gold 6248R using the parameters in the bash file, with multiple tasks run simultaneously
2. **run_2.sh**: < 5 mins
   - each task tested on 45 cores of Intel Xeon Gold 6248R using the parameters in the bash file, with multiple tasks run simultaneously